<!doctype html>
<html lang="en" class="bg-white text-gray-900 dark:bg-gray-900 dark:text-gray-100">
<head>
  <meta charset="UTF-8">
  <title>Luke Priest's Portfolio</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Luke Priest's professional portfolio showcasing experience as an IT Technician, certifications, projects, networking, hardware, and customer support.">
  <meta name="author" content="Luke Priest">
  <meta name="keywords" content="Luke Priest, Portfolio, IT Technician, CompTIA A+, CompTIA Network+, Dayton STEM School">
  <link rel="icon" type="image/x-icon" href="favicon.ico">
  <link href="../src/output.css" rel="stylesheet">

  <meta property="og:title" content="Luke Priest's Portfolio" />
  <meta property="og:description" content="Accredited IT Technician in Dayton, Ohio" />
  <meta property="og:image" content="https://lukepriest.work/img/Me.avif" />
  <meta property="og:url" content="https://lukepriest.work/" />
  <meta property="og:type" content="website" />
  <meta property="og:site_name" content="Luke Priest IT Technician" />
  <meta property="og:locale" content="en_US" />
  <meta property="og:updated_time" content="2025-07-27T23:00:06+0000" />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" rel="stylesheet">

  <style>
    html { font-family: 'Inter', ui-sans-serif, system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, 'Noto Sans', sans-serif; }

    .skill-badge { background-color: #dbeafe; color: #1e40af; padding: .5rem 1rem; border-radius: 9999px; font-weight: 500; transition: background-color .3s, color .3s; }
    @media (prefers-color-scheme: dark) { .skill-badge { background-color: #1e3a8a; color: #bfdbfe; } }

    .hidden-section { opacity: 0; transform: translateY(20px); transition: opacity .8s ease-out, transform .8s ease-out; }
    .hidden-item { opacity: 0; transform: translateY(10px); transition: opacity .6s ease-out, transform .6s ease-out; }
    .animated-section.visible, .animated-item.visible { opacity: 1; transform: translateY(0); }
    .animated-section.visible .hidden-item:nth-child(1) { transition-delay: .1s; }
    .animated-section.visible .hidden-item:nth-child(2) { transition-delay: .2s; }
    .animated-section.visible .hidden-item:nth-child(3) { transition-delay: .3s; }
    .animated-section.visible .hidden-item:nth-child(4) { transition-delay: .4s; }
    .animated-section.visible .hidden-item:nth-child(5) { transition-delay: .5s; }
    .animated-section.visible .hidden-item:nth-child(6) { transition-delay: .6s; }

    @keyframes fadeInSlideUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0);} }
    .animate-hero-text { animation: fadeInSlideUp 1s ease-out forwards; opacity: 0; }

    nav a { padding: .5rem 1rem; border-radius: 9999px; transition: all .3s ease; }
    nav a:hover { background-color: rgba(147, 197, 253, 0.3); }

    @media (max-width: 768px) { nav.nav-pill { left: 50%; transform: translateX(-50%); width: 92%; padding: .75rem 1rem; } }

    #ticket-popup, #homelab-popup, #contact-popup, #powerApps-popup { max-height: 90vh; overflow-y: auto; -webkit-overflow-scrolling: touch; }

    @keyframes fadeIn { from { opacity: 0; transform: translateY(4px); } to { opacity: 1; transform: translateY(0); } }

    /* --- YEAR PILL LAYOUT (fixed size; variable-width buttons) --- */
    .year-glass { position: relative; border-radius: 9999px; -webkit-backdrop-filter: blur(12px); backdrop-filter: blur(12px); }
    .year-pill { position: relative; padding: 0.5rem 0.75rem; border-radius: 9999px; border: 1px solid rgba(0, 0, 0, 0.06); overflow: hidden; height: 3.25rem; box-sizing: border-box; width: 300px }
    .dark .year-pill { border-color: rgba(255, 255, 255, 0.08); }

    .year-highlight { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); height: 2.25rem; width: 7.75rem; border-radius: 9999px; z-index: 1; box-shadow: inset 0 8px 24px rgba(0, 0, 0, 0.06), 0 2px 8px rgba(0, 0, 0, 0.08); background: rgba(255, 255, 255, 0.55); border: 1px solid rgba(255, 255, 255, 0.5); transition: width 0.25s ease; }
    .dark .year-highlight { background: rgba(17, 24, 39, 0.55); border-color: rgba(255, 255, 255, 0.08); box-shadow: inset 0 8px 24px rgba(255, 255, 255, 0.03), 0 2px 8px rgba(0, 0, 0, 0.35); }

    .year-rail { display: flex; align-items: center; gap: 0.5rem; overflow-x: auto; scroll-snap-type: x mandatory; -webkit-overflow-scrolling: touch; scrollbar-width: none; height: 100%; }
    .year-rail::-webkit-scrollbar { display: none; }
    .year-item, .year-spacer { flex: 0 0 auto; display: grid; place-items: center; scroll-snap-align: center; scroll-snap-stop: always; height: 100%; }

    .year-btn { position: relative; z-index: 2; user-select: none; cursor: pointer; font-weight: 800; letter-spacing: 0.08em; text-transform: uppercase; padding: 0 0.6rem; border-radius: 0.75rem; transition: transform 0.2s ease, opacity 0.2s ease, color 0.2s ease; color: rgba(17, 24, 39, 0.7); font-size: 0.95rem; height: 2.25rem; display: inline-flex; align-items: center; justify-content: center; line-height: 1; }
    .year-btn[aria-current="true"] { color: #111827; transform: scale(1.06); opacity: 1; }
    .dark .year-btn { color: rgba(255, 255, 255, 0.7); }
    .dark .year-btn[aria-current="true"] { color: #fff; }

    /* End indicators */
    .year-indicator { position: absolute; top: 50%; transform: translateY(-50%); z-index: 3; font-weight: 800; font-size: 1rem; line-height: 1; padding: 0.25rem 0.4rem; border-radius: 9999px; background: rgba(255,255,255,0.7); color: rgba(17,24,39,0.6); box-shadow: 0 2px 6px rgba(0,0,0,0.12); pointer-events: none; opacity: 0; transition: opacity .2s ease; }
    .dark .year-indicator { background: rgba(17,24,39,0.6); color: rgba(255,255,255,0.75); }

    .year-fade { position: absolute; top: 0; bottom: 0; width: 42px; z-index: 2; pointer-events: none; opacity: 0; transition: opacity .2s ease; background: linear-gradient(to right, rgba(255,255,255,1), rgba(255,255,255,0)); }
    .year-fade.right { right: 0; background: linear-gradient(to left, rgba(255,255,255,1), rgba(255,255,255,0)); }
    .dark .year-fade { background: linear-gradient(to right, rgba(17,24,39,1), rgba(17,24,39,0)); }
    .dark .year-fade.right { background: linear-gradient(to left, rgba(17,24,39,1), rgba(17,24,39,0)); }

    /* === NEW: nav hide animation === */
    .nav-animate {
      transition: opacity .25s ease, transform .25s ease, visibility .25s ease;
    }
    .nav-hidden {
      opacity: 0;
      transform: translateY(-8px);
      visibility: hidden;
      pointer-events: none;
    }
  </style>

  <script>
    // Dark mode init + toggle
    if ( localStorage.theme === 'dark' || (!('theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches) ) {
      document.documentElement.classList.add('dark');
    } else { document.documentElement.classList.remove('dark'); }
    function toggleDarkMode(){
      document.documentElement.classList.toggle('dark');
      localStorage.theme = document.documentElement.classList.contains('dark') ? 'dark' : 'light';
    }
  </script>
</head>
<body>

<!-- Desktop nav -->
<nav id="nav-desktop" class="hidden md:block fixed inset-x-0 top-0 z-40 nav-animate">
  <div class="nav-pill pointer-events-auto fixed top-4 left-1/2 -translate-x-1/2 backdrop-blur-lg bg-white/30 dark:bg-gray-900/30 border border-gray-200/30 dark:border-gray-700/30 rounded-full shadow-lg px-6 py-3">
    <div class="flex items-center space-x-6">
      <a href="../index.html" class="text-gray-900 dark:text-gray-100 hover:text-blue-600 dark:hover:text-blue-300 font-medium transition-colors">Home</a>
      <a href="" class="text-gray-900 dark:text-gray-100 hover:text-blue-600 dark:hover:text-blue-300 font-medium transition-colors">Projects</a>
      <a href="../Experiences/index.html" class="text-gray-900 dark:text-gray-100 hover:text-blue-600 dark:hover:text-blue-300 font-medium transition-colors">Experiences</a>
      <a href="../WBL/index.html" class="text-gray-900 dark:text-gray-100 hover:text-blue-600 dark:hover:text-blue-300 font-medium transition-colors">WBL</a>
      <a href="../STEM/index.html" class="text-gray-900 dark:text-gray-100 hover:text-blue-600 dark:hover:text-blue-300 font-medium transition-colors">STEM</a>
      <a href="../Coding/index.html" class="text-gray-900 dark:text-gray-100 hover:text-blue-600 dark:hover:text-blue-300 font-medium transition-colors">Coding</a>
    </div>
  </div>
</nav>

<!-- Mobile hamburger (unchanged visually; gets hidden via JS) -->
<input id="nav-check" type="checkbox" class="peer sr-only" />
<label id="nav-mobile-btn" for="nav-check" class="md:hidden fixed top-4 right-4 z-50 inline-flex items-center justify-center rounded-full p-4 backdrop-blur-lg bg-white/60 dark:bg-gray-800/60 text-gray-900 dark:text-gray-100 border border-gray-200/40 dark:border-gray-700/40 shadow-lg cursor-pointer nav-animate">
  <svg class="h-8 w-8 peer-checked:hidden" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/></svg>
  <svg class="h-8 w-8 hidden peer-checked:block" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/></svg>
  <span class="sr-only">Toggle menu</span>
</label>
<div class="md:hidden fixed inset-0 z-40 hidden peer-checked:block">
  <label for="nav-check" class="absolute inset-0 backdrop-blur-xl bg-white/85 dark:bg-gray-900/85"></label>
  <div class="relative h-full w-full flex flex-col items-center mt-20 gap-6 p-6 animate-[fadeIn_150ms_ease-out]">
    <label for="nav-check" class="w-full max-w-md"><a href="../index.html" class="block text-center text-2xl font-semibold text-gray-900 dark:text-gray-100 py-4 rounded-xl bg-white/80 dark:bg-gray-800/80 border border-gray-200/50 dark:border-gray-700/50 shadow">Home</a></label>
    <label for="nav-check" class="w-full max-w-md"><a href="" class="block text-center text-2xl font-semibold text-gray-900 dark:text-gray-100 py-4 rounded-xl bg-white/80 dark:bg-gray-800/80 border border-gray-200/50 dark:border-gray-700/50 shadow">Projects</a></label>
    <label for="nav-check" class="w-full max-w-md"><a href="../Experience/index.html" class="block text-center text-2xl font-semibold text-gray-900 dark:text-gray-100 py-4 rounded-xl bg-white/80 dark:bg-gray-800/80 border border-gray-200/50 dark:border-gray-700/50 shadow">Experiences</a></label>
    <label for="nav-check" class="w-full max-w-md"><a href="../WBL/index.html" class="block text-center text-2xl font-semibold text-gray-900 dark:text-gray-100 py-4 rounded-xl bg-white/80 dark:bg-gray-800/80 border border-gray-200/50 dark:border-gray-700/50 shadow">WBL</a></label>
    <label for="nav-check" class="w-full max-w-md"><a href="../STEM/index.html" class="block text-center text-2xl font-semibold text-gray-900 dark:text-gray-100 py-4 rounded-xl bg-white/80 dark:bg-gray-800/80 border border-gray-200/50 dark:border-gray-700/50 shadow">STEM</a></label>
    <label for="nav-check" class="w-full max-w-md"><a href="../Coding/index.html" class="block text-center text-2xl font-semibold text-gray-900 dark:text-gray-100 py-4 rounded-xl bg-white/80 dark:bg-gray-800/80 border border-gray-200/50 dark:border-gray-700/50 shadow">Coding</a></label>
  </div>
</div>

<header id="site-hero" class="flex flex-col md:flex-row items-center justify-between min-h[60vh] md:min-h-screen px-4 md:px-16 py-8 md:py-12 bg-gradient-to-br from-blue-200 via-white to-blue-50 dark:from-gray-800 dark:via-gray-900 dark:to-blue-900 relative overflow-hidden">
  <svg class="absolute top-0 left-0 w-full h-full pointer-events-none opacity-30" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="none" viewBox="0 0 1440 800" fill="none">
    <defs>
      <linearGradient id="bg-gradient" x1="0" y1="0" x2="1440" y2="800" gradientUnits="userSpaceOnUse">
        <stop stop-color="#60A5FA"/>
        <stop offset="1" stop-color="#F0F9FF"/>
      </linearGradient>
      <linearGradient id="bg-gradient-dark" x1="0" y1="0" x2="1440" y2="800" gradientUnits="userSpaceOnUse">
        <stop stop-color="#1e3a8a"/>
        <stop offset="1" stop-color="#0f172a"/>
      </linearGradient>
    </defs>
    <path d="M0,400 Q360,600 720,400 T1440,400 V800 H0 Z" fill="url(#bg-gradient)" class="dark:hidden"/>
    <path d="M0,400 Q360,600 720,400 T1440,400 V800 H0 Z" fill="url(#bg-gradient-dark)" class="hidden dark:inline"/>
  </svg>
  <svg class="absolute top-0 left-0 w-full h-full pointer-events-none z-10" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1440 800">
    <circle cx="83%" cy="25%" r="180" fill="#93C5FD" opacity="0.09"/>
    <circle cx="21%" cy="13%" r="120" fill="#3B82F6" opacity="0.05"/>
  </svg>
  <div class="flex-1 w-full relative z-10 flex items-center justify-center text-center">
    <h1 class="text-4xl sm:text-5xl md:text-7xl lg:text-8xl xl:text-9xl font-bold text-gray-900 dark:text-white mb-4 md:mb-6 drop-shadow-lg animate-hero-text">Projects</h1>
  </div>
</header>

<main class="px-4 md:px-16 py-8 bg-white dark:bg-gray-900">
  <section aria-labelledby="viewer-title" class="w-full h-full mx-auto">
  <div class="mb-4 md:mb-6 text-center">
    <h2 id="viewer-title" class="text-2xl md:text-3xl font-bold text-gray-900 dark:text-gray-100">
      Yearly Project Pages
    </h2>
    <p class="mt-1 text-sm text-gray-600 dark:text-gray-400">
      NOTE: pages earlier than 2023 are original and WILL have visual bugs.
    </p>
  </div>

  <div class="relative flex justify-center mb-6">
    <div>
      <div class="year-pill scroll">
        <div class="year-highlight" id="year-highlight"></div>
        <div class="year-rail" id="year-rail" aria-label="Year selector" role="tablist"></div>
        <div id="year-fade-left" class="year-fade left"></div>
        <div id="year-fade-right" class="year-fade right"></div>
        <div id="year-ind-left" class="year-indicator" style="left:6px">&#x276E;</div>
        <div id="year-ind-right" class="year-indicator" style="right:6px">&#x276F;</div>
      </div>
    </div>
  </div>

  <!-- Centered iframe container -->
  <div class="max-w-[2500px] mx-auto w-full rounded-2xl overflow-hidden border border-gray-200 dark:border-gray-800 shadow-lg">
    <iframe
      id="year-iframe"
  title="Embedded Project Page"
  class="w-full h-[72vh] md:h-[90vh] bg-white dark:bg-gray-900"
  referrerpolicy="no-referrer"
  sandbox=""
  src="about:blank">

    </iframe>
  </div>
</section>

</main>

<script>
  /* ---------- Config ---------- */
  var PAGES = {
    2020: "6th/6th.html",
    2021: "7th/7th.html",
    2022: "8th/8th.html",
    2023: "9th/9th.html",
    2024: "10th/10th.html",
    2025: "11th/11th.html",
    2026: "12th.html"
  };

  /* ---------- DOM ---------- */
  var years     = Object.keys(PAGES).sort(function(a,b){ return a.localeCompare(b); });
  var rail      = document.getElementById("year-rail");
  var highlight = document.getElementById("year-highlight");
  var iframe    = document.getElementById("year-iframe");
  var fadeL     = document.getElementById("year-fade-left");
  var fadeR     = document.getElementById("year-fade-right");
  var indL      = document.getElementById("year-ind-left");
  var indR      = document.getElementById("year-ind-right");

  /* ---------- Ephemeral state ---------- */
  var state = { activeIndex:-1, currentYear:null, lockScroll:false };

  /* ---------- Utils ---------- */
  function normalizedHref(rel){ return new URL(rel, document.baseURI).href; }
  function makeSpacer(){
    var d = document.createElement("div");
    d.className = "year-spacer";
    d.style.width = "0px";
    return d;
  }

  /* ---------- Build rail ---------- */
  var leftSpacer = makeSpacer();
  var rightSpacer = makeSpacer();
  rail.appendChild(leftSpacer);

  years.forEach(function(year, idx){
    var cell = document.createElement("div");
    cell.className = "year-item";

    var btn = document.createElement("button");
    btn.type = "button";
    btn.className = "year-btn";
    btn.role = "tab";
    btn.textContent = year;
    btn.dataset.index = String(idx);

    btn.addEventListener("click", function(){ centerTo(idx, { set:true, animate:true }); });
    btn.addEventListener("keydown", function(e){
      if (e.key === "Enter" || e.key === " ") {
        e.preventDefault();
        centerTo(idx, { set:true, animate:true });
      }
    });

    cell.appendChild(btn);
    rail.appendChild(cell);
  });
  rail.appendChild(rightSpacer);

  /* ---------- Core behaviors ---------- */
  function centerTo(index, opts){
    opts = opts || {};
    var set = !!opts.set;
    var animate = (opts.animate !== false);

    var buttons = rail.querySelectorAll(".year-btn");
    var btn = buttons[index];
    if (!btn) return;

    var target = btn.offsetLeft - (rail.clientWidth - btn.offsetWidth) / 2;
    var max = Math.max(0, rail.scrollWidth - rail.clientWidth);
    var left = Math.min(Math.max(0, target), max);
    rail.scrollTo({ left: left, behavior: animate ? "smooth" : "auto" });

    if (set) setActive(index);
  }

  function setActive(index){
    if (index === state.activeIndex) return;

    var buttons = rail.querySelectorAll(".year-btn");
    buttons.forEach(function(b,i){
      b.setAttribute("aria-current", i===index ? "true" : "false");
      b.tabIndex = i===index ? 0 : -1;
    });

    var activeBtn = buttons[index];
    var pad = 20;
    var w = activeBtn.getBoundingClientRect().width;
    highlight.style.width = Math.max(72, w + pad) + "px";

    var year = years[index];
    if (year !== state.currentYear) {
      var url = normalizedHref(PAGES[year]);
      loadIntoIframe(url);
      state.currentYear = year;
    }

    state.activeIndex = index;
  }

  function nearestIndex(){
    var buttons = rail.querySelectorAll(".year-btn");
    var viewportCenter = rail.scrollLeft + rail.clientWidth / 2;
    var best = 0, bestDist = Infinity;

    buttons.forEach(function(btn, i){
      var center = btn.offsetLeft + btn.offsetWidth / 2;
      var d = Math.abs(center - viewportCenter);
      if (d < bestDist) { bestDist = d; best = i; }
    });
    return best;
  }

  function updateIndicators(){
    var atStart = rail.scrollLeft <= 2;
    var atEnd = rail.scrollLeft >= (rail.scrollWidth - rail.clientWidth - 2);
    if (fadeL) fadeL.style.opacity = atStart ? "0" : "1";
    if (fadeR) fadeR.style.opacity = atEnd ? "0" : "1";
    if (indL)  indL.style.opacity  = atEnd ? "1" : "0";
    if (indR)  indR.style.opacity  = atStart ? "1" : "0";
  }

  /* ---------- Safe loader (fetch -> sanitize -> srcdoc) ---------- */
  function loadIntoIframe(url){
    fetch(url, { cache: "no-store", redirect: "follow" })
      .then(function(res){
        if (!res.ok) throw new Error("HTTP error " + res.status);
        return res.text();
      })
      .then(function(html){
        // Trim common download/redirect vectors
        html = html.replace(/<meta[^>]+http-equiv=["']?refresh["']?[^>]*>/gi, "");
        html = html.replace(/\sdownload(=(["']).*?\2)?/gi, "");
        html = html.replace(/target=(["'])_blank\1/gi, 'target="_self"');

        // Resolve relative paths from the year's folder
        var baseHref = url.slice(0, url.lastIndexOf("/") + 1);

        // CSP: allow JS/CSS/assets, PDF via <object>/<embed>, nested iframes; still no downloads.
        var wrapperStart =
          "<!doctype html><html><head>" +
          "<meta charset=\"utf-8\">" +
          "<meta http-equiv=\"Content-Security-Policy\" content=\"" +
            "default-src 'none'; " +
            "script-src 'self' https: 'unsafe-inline' 'unsafe-eval'; " +
            "style-src 'self' https: 'unsafe-inline'; " +
            "img-src 'self' https: data: blob:; " +
            "font-src 'self' https: data:; " +
            "media-src 'self' https: blob:; " +
            "object-src 'self' https: blob: data:; " +
            "plugin-types application/pdf; " +
            "frame-src 'self' https: blob: data:; " +
            "connect-src 'self' https:; " +
            "navigate-to 'self' https:; " +
            "frame-ancestors 'none'; " +
            "form-action 'self' https:;" +
          "\">" +
          "<meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">" +
          "<base href=\"" + baseHref + "\" target=\"_self\">" +
          "<style>html,body{margin:0;padding:0;}</style>" +
          "<script>(function(){document.addEventListener('click',function(e){var a=e.target.closest&&e.target.closest('a');if(!a)return;var href=a.getAttribute('href')||'';if(/^blob:|^data:/.test(href)){e.preventDefault();e.stopPropagation();}},true);}());<\/script>" +
          "</head><body>";

        var wrapperEnd = "</body></html>";

        // Enable JS in the inner doc; still no popup/download permissions.
        iframe.removeAttribute("src");
        iframe.setAttribute("sandbox", "allow-scripts allow-same-origin allow-forms");
        iframe.srcdoc = wrapperStart + html + wrapperEnd;
      })
      .catch(function(err){
        var safeUrl = url.replace(/</g,"&lt;").replace(/>/g,"&gt;");
        var fallback =
          "<!doctype html><html><head><meta charset=\"utf-8\"><meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">" +
          "<style>body{font:14px system-ui, sans-serif; padding:1rem;}</style></head><body>" +
          "<h2>Canâ€™t display this page safely</h2>" +
          "<p>Tried to load <code>" + safeUrl + "</code>.</p>" +
          "<p><strong>Tip:</strong> open the site via <code>http://localhost</code> so assets have proper headers.</p>" +
          "</body></html>";

        iframe.removeAttribute("src");
        iframe.setAttribute("sandbox", "");
        iframe.srcdoc = fallback;
      });
  }

  /* ---------- Intro sweep ---------- */
  function runIntroScroll(){
    try { if (window.matchMedia("(prefers-reduced-motion: reduce)").matches) return; } catch(e){}
    var max = Math.max(0, rail.scrollWidth - rail.clientWidth);
    if (max <= 0) return;

    state.lockScroll = true;
    rail.scrollLeft = 0;
    updateIndicators();

    var duration = Math.max(1500, Math.min(3500, max * 2));
    var start = performance.now();
    function ease(t){ return t < 0.5 ? 2*t*t : -1 + (4 - 2*t)*t; }
    function step(now){
      var t = Math.min(1, (now - start) / duration);
      rail.scrollLeft = max * ease(t);
      updateIndicators();
      if (t < 1) requestAnimationFrame(step);
      else { state.lockScroll = false; var i = nearestIndex(); centerTo(i, { set:true, animate:true }); }
    }
    requestAnimationFrame(step);
  }

  /* ---------- Events ---------- */
  var debounce;
  rail.addEventListener("scroll", function(){
    if (state.lockScroll) return;
    clearTimeout(debounce);
    debounce = setTimeout(function(){
      var i = nearestIndex();
      if (i !== state.activeIndex) { centerTo(i, { animate:true }); setActive(i); }
      updateIndicators();
    }, 120);
  }, { passive:true });

  rail.addEventListener("keydown", function(e){
    var buttons = rail.querySelectorAll(".year-btn");
    var current = (state.activeIndex >= 0)
      ? state.activeIndex
      : parseInt((Array.prototype.find.call(buttons, function(b){ return b.getAttribute("aria-current")==="true"; }) || { dataset:{ index:"0" } }).dataset.index, 10);

    if (e.key === "ArrowLeft")  { e.preventDefault(); centerTo(Math.max(0, current-1), { set:true }); }
    if (e.key === "ArrowRight") { e.preventDefault(); centerTo(Math.min(years.length-1, current+1), { set:true }); }
    if (e.key === "Enter" || e.key === " ") { e.preventDefault(); centerTo(current, { set:true }); }
  });

  window.addEventListener("resize", function(){
    var buttons = rail.querySelectorAll(".year-btn");
    var current = (state.activeIndex >= 0)
      ? state.activeIndex
      : parseInt((Array.prototype.find.call(buttons, function(b){ return b.getAttribute("aria-current")==="true"; }) || { dataset:{ index:"0" } }).dataset.index, 10);

    var railPadding = 12;
    leftSpacer.style.width = rightSpacer.style.width = String((rail.clientWidth/2) - railPadding) + "px";
    centerTo(current, { animate:false });
    updateIndicators();
  });

  /* ---------- Init ---------- */
  (function init(){
    var railPadding = 12;
    leftSpacer.style.width = rightSpacer.style.width = String((rail.clientWidth/2) - railPadding) + "px";
    rail.setAttribute("tabindex", "0");

    var startIdx = years.length - 1; // latest year
    centerTo(startIdx, { animate:false, set:true });
    requestAnimationFrame(updateIndicators);

    var pill = document.querySelector(".year-pill");
    if (pill) {
      var ioPill = new IntersectionObserver(function(entries, obs){
        for (var i=0; i<entries.length; i++){
          if (entries[i].isIntersecting) { runIntroScroll(); obs.disconnect(); break; }
        }
      }, { threshold: 1 });
      ioPill.observe(pill);
    }

    // Optional nav visibility (no persistence)
    var hero        = document.getElementById("site-hero");
    var navDesktop  = document.getElementById("nav-desktop");
    var navMobileBtn= document.getElementById("nav-mobile-btn");
    var navCheck    = document.getElementById("nav-check");

    if (hero) {
      var ioHero = new IntersectionObserver(function(entries){
        var entry = entries[0];
        var heroVisible = entry && entry.isIntersecting;
        if (!heroVisible) {
          if (navDesktop)  navDesktop.classList.add("nav-hidden");
          if (navMobileBtn)navMobileBtn.classList.add("nav-hidden");
          if (navCheck && navCheck.checked) navCheck.checked = false;
        } else {
          if (navDesktop)  navDesktop.classList.remove("nav-hidden");
          if (navMobileBtn)navMobileBtn.classList.remove("nav-hidden");
        }
      }, { root:null, threshold:0.01, rootMargin:"0px" });
      ioHero.observe(hero);
    }
  })();
</script>





</body>
</html>
